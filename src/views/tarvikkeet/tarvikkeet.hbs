<div class="page-container mt-4">

  {{> otsikkoJaNappi
  title="Tarvikkeet"
  hxGetUrl="/tarvikkeet/arkisto"
  hxTarget="#main-content"
  hxPushUrl="true"
  buttonText="Arkisto"
  isDisabled=false}}


  {{#if writeAccess}}
  <div class="mt-8">
    <form enctype="multipart/form-data" hx-encoding="multipart/form-data" hx-post="/tarvikkeet/lataa"
      hx-trigger="submit" hx-target="#main-content">
      <div class="mt-2">
        <label for="file-input"
          class="bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white mr-4 py-2 px-4 border border-blue-500 hover:border-transparent rounded">
          Lataa toimittajan tarvikelista
        </label>
        <input multiple id="file-input" type="file" name="items-files" accept=".xml" class="file:hidden max-w-32">
        <input type="submit" value="Lähetä" class="border rounded bg-transparent px-2 m-2 mt-0 py-1 hover:bg-gray-100">
      </div>
      <p class="ml-1 mb-2">HUOM! Uuden tarvikelistan lataaminen siirtää toimittajan aiemmat tarvikkeet arkistoon.</p>
    </form>
  </div>
  {{/if}}


  <table class="w-full text-left text-sm">
    <thead class="font-bold border-b-2 border-black">
      <tr>
        <th scope="col">Nimi</th>
        <th scope="col">Merkki</th>
        <th scope="col">Tyyppi</th>
        <th scope="col">Yksikkö</th>
        <th scope="col">Toimittaja</th>
        <th scope="col">Varastotilanne</th>
        <th scope="col">Hinta sisään</th>
        {{#if writeAccess}}
        <th scope="col">Arkistoi</th>
        {{/if}}
      </tr>
    </thead>
    <tbody>
      {{#each warehouseItems}}

      <tr hx-get="/tarvikkeet/{{this.id}}" hx-target="#main-content" hx-push-url="true"
        class="hover:bg-slate-300 odd:bg-slate-100 cursor-pointer">
        <td class="p-2">{{this.nimi}}</td>
        <td class="p-2">{{this.merkki}}</td>
        <td class="p-2">{{this.tyyppi}}</td>
        <td class="p-2">{{this.yksikko}}</td>
        <td class="p-2 ">{{this.toimittaja_nimi}}</td>
        <td class="p-2">{{this.varastotilanne}} {{this.yksikko}}</td>
        <td class="p-2">{{this.hinta_sisaan}}
          {{#if ../writeAccess}}
        <td class="p-2">
          <button hx-patch="tarvikkeet/{{this.id}}" hx-vals='{"vanhentunut": "{{not this.vanhentunut}}"}'
            hx-trigger="click consume" class="border rounded p-2 hover:border-blue-700">
            &#10060
          </button>
        </td>
        {{/if}}
      </tr>
      {{/each}}
    </tbody>
  </table>
</div>