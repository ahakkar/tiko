<h1 class="font-medium text-3xl">Työsopimus #{{tyosopimus.id}}</h1>

<div>
  {{#if is_urakka}}<div>Sopimustyyppi: Urakkasopimus</div>{{/if}}
  {{#if is_tuntihinta}}<div>Sopimustyyppi: Tuntityösopimus</div>{{/if}}
  <div>Kohdeosoite: {{tyokohde.osoite}}</div>
  <div>Aloituspäivämäärä: {{formatDate tyosopimus.aloitus_pvm}}</div>
  <div class="flex items-center">
    <span class="pr-1">Työsopimuksen tila:</span>
    {{#if writeAccess}}
    <select name="tila" hx-patch="/tyosopimukset/{{tyosopimus.id}}"
      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5">
      <option value="">{{tyosopimus.tila}}</option>
      <option value="">---------------</option>
      {{#each tilat}}
      <option value="{{this}}">{{this}}</option>
      {{/each}}
    </select>
    {{else}}
    <span>{{tyosopimus.tila}}</span>
    {{/if}}
  </div>
</div>

<div class="grid grid-cols-2 mt-4">
  <div>
    <h2 class="font-medium text-xl">Asiakas</h2>
    <div class="flex">
      <div>
        <div>{{asiakas.nimi}}</div>
        <div>{{asiakas.sahkoposti}}</div>
        <div>{{asiakas.puhelinnumero}}</div>
      </div>
      <div class="px-10"></div>
      <div class="shrink-0">
        <div>{{asiakas.osoite}}</div>
        <div>{{asiakas.postinumero}}, {{asiakas.postitoimipaikka}}</div>
      </div>
    </div>
  </div>

  <div>
    <h2 class="font-medium text-xl">Työkohde</h2>
    <div>{{tyokohde.osoite}}</div>
    <div>{{tyokohde.postinumero}}, {{tyokohde.postitoimipaikka}}</div>
    <div class="capitalize">{{tyokohde.tyyppi}}</div>
  </div>
</div>

<div class="mt-4">
  {{> laskutLista laskut=laskut}}

  {{#if writeAccess}}
  <button hx-get="/tyosopimukset/{{tyosopimus.id}}/laskut" hx-target="#modal-content"
    class="bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded my-2">
    Uusi lasku
  </button>
  {{/if}}
</div>

<div class="mt-4">
  {{> tarvikkeetLista tarvikkeet=tarvikkeet}}

  {{#if is_editable}}
  {{#if writeAccess}}
  <button hx-get="/tyosopimukset/{{tyosopimus.id}}/tarvikkeet/uusi" hx-target="#modal-content"
    class="bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded my-2">
    Uusi tarvike
  </button>
  {{/if}}
  {{/if}}
</div>

<div class="mt-4">
  {{> tyosuorituksetLista tyosuoritukset=tyosuoritukset}}

  {{#if is_editable}}
  {{#if writeAccess}}
  <button hx-get="/tyosopimukset/{{tyosopimus.id}}/tyot/uusi" hx-target="#modal-content"
    class="bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded my-2">
    Uusi työsuoritus
  </button>
  {{/if}}
  {{/if}}
</div>

<div class="grid grid-cols-2 mt-4">
  <div class="grid grid-cols-2">
    <div>ALV-erittely:</div>
    <div></div>
    {{#each alv_erittely}}
    <div>ALV {{formatPercentage alv_prosentti}}:</div>
    <div>{{alv_summa}} €</div>
    {{/each}}
  </div>

  <div class="grid grid-cols-2">
    {{#if is_urakka}}
    <div>Urakan aleprosentti:</div>
    <div>{{formatPercentage urakka.aleprosentti}}</div>

    <div>Urakan korotusprosentti:</div>
    <div>{{formatPercentage urakka.korotusprosentti}}</div>
    {{/if}}

    <div class="mt-4">Lähtöhinta ALV 0 %:</div>
    <div class="mt-4">{{summat.lahtohinta}} €</div>

    <div>Alehinta ALV 0 %:</div>
    <div>{{summat.alehinta}} €</div>

    <div>Yhteensä sis. ALV:</div>
    <div>{{summat.alv_hinta}} €</div>
  </div>
</div>